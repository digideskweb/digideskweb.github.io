{"response": [{"author_name": "Jeff Atwood", "gravatar_hash": "51d623f33f8b83095db84ff35e15dbe8", "author_url": "http://www.codinghorror.com/blog/", "date": "Feb 06, 2009", "message": "Another data point; the Alan Kay \"Significant new inventions in computing since 1980\", loaded repeatedly in Firebug, on both servers.\n\nnew:\nGET 432922 -- 201 ms\nDomContentLoaded -- 562 ms\n\nold:\nGET 432922 -- 320 ms\nDomContentLoaded -- 628 ms"}, {"author_name": "friism", "gravatar_hash": "7fac8898f9d4ef5afebc4eded763a6b8", "author_url": "http://friism.com", "date": "Feb 06, 2009", "message": "Ahh, the joys of building and managing your own hardware are many and varied... :-)."}, {"author_name": "srboisvert", "gravatar_hash": "f8c6f7475c4b8b04781baf378aba2673", "author_url": "http://blog.ennuyer.net", "date": "Feb 06, 2009", "message": "I had a similar experience with SCSI drivers on a tape backup unit setup by the tech support at my last job.  Out of date drivers meant backing up one tape worth of data would have taken about a week.\n\nI knew tape drives were slow but that shocked me so I did some googling and found out the windows drivers were pooh.  Not that anybody other than me cared."}, {"author_name": "Jason Baker", "gravatar_hash": "9778f2a6432262a59c6f7a2f96b33f90", "author_url": "http://jasonmbaker.wordpress.com", "date": "Feb 06, 2009", "message": "You got lucky.  The horrors of software written by hardware manufacturers can get pretty bad."}, {"author_name": "Marko", "gravatar_hash": "8c9f9547c0f7d9f7bc57cee1c20b8bcb", "author_url": null, "date": "Feb 06, 2009", "message": "So, Jeff, I guess that low level coding is important after all.\n\nSomebody's C/assembler/other low level coding skills just boosted the performance more than the hardware you threw at it."}, {"author_name": "BobbyShaftoe", "gravatar_hash": "526f22eb98e81ea305bdcf777e4f733d", "author_url": null, "date": "Feb 06, 2009", "message": "It's a good thing someone at Broadcom knew C and didn't think optimization was bogus. :)"}, {"author_name": "Sean Ennis", "gravatar_hash": "9b5b69a29967dc41d5ddfdee09b27b73", "author_url": null, "date": "Feb 06, 2009", "message": "Of course, then there are the times that the latest update is actually broken or slower than the old one. Then you have to hope you can revert to version n-1 or wait for n+1 - *chough* Oracle *cough*.\n\nI'd be curious as to what the release notes say were fixed between the old and new versions."}, {"author_name": "Kamil Zadora", "gravatar_hash": "ce9a46a386f4cc5aaa71c683b8027cb0", "author_url": "http://kamilzadora.com", "date": "Feb 06, 2009", "message": "Well, I would blame Microsoft anyway ;) if their default network divers wouldn't work at all with your NIC, then you would just install the new drivers a long time ago and the problem would never existed :)"}, {"author_name": "Marshall", "gravatar_hash": "8428511b65515cc8498ef53b3f198504", "author_url": "http://www.cannla.com", "date": "Feb 06, 2009", "message": "here's hoping all your perf gains come so easily."}, {"author_name": "Andre Bluehs", "gravatar_hash": "57caba2cbe81c024ab774cd69df62a7f", "author_url": "http://andrebluehs.net", "date": "Feb 06, 2009", "message": "Here's another question. Will you run into this again? Are there any more drivers that you potentially forgot to/didn't yet upgrade? You did RAID, NIC. What about BIOS, any other firmware?\n\nOr will we be having another blog post soon with another \"Doh!\"."}, {"author_name": "Aaron Seet", "gravatar_hash": "3c4fe77ab5bf8851c0dd7da1b3d3960c", "author_url": "http://icelava.net", "date": "Feb 06, 2009", "message": "Latest drivers or firmware does not always mean better or faster. There are many cases of newer drivers exihibiting slower performance due to fixes to issues (unavoidable or not, depends).\n\nSometimes, newer versions are plain unstable and unusable - I had a motherboard BIOS version completely stall video refresh and thus make the computer \"blind\" and unusable; had to downgrade a version in order to get a stable working motherboard."}, {"author_name": "Anthony DeRobertis", "gravatar_hash": "05b48b72766177b3b0a6ff4afdb70790", "author_url": null, "date": "Feb 06, 2009", "message": "With NIC drivers there is a balance between latency and CPU load. In particular, if you interrupt the host CPU each packet, that's great for latency. If you wait for N packets (or N ms), that's great for CPU load.\n\nSO probably isn't pushing that much data between the SQL Server and web server. In which case, you probably want the better latency.\n\nUsually, this trade-off is tunable. I'd guess the vendor re-tuned the default. You may get performance gains by fiddling with the tuning.\n\n(Or, at least, this is tunable on Linux; I assume it is on Windows too.)"}, {"author_name": "Michael Gorsuch", "gravatar_hash": "48ae1f8c02a933aa17f6cf68fad13399", "author_url": "http://www.fogcreek.com", "date": "Feb 06, 2009", "message": "Jeff - great call on the NIC driver.  I am always surprised at how little things like that can make such a difference.  \n\nSome things that you may want to examine if you run into this down the line:\n\n* Did you split put your database server and web servers on different network segments (one a DMZ segment the other just for DB servers)?  If so, your router's throughput may end up getting in the way.  \n\n* Either way, consider using IPerf (http://www.noc.ucf.edu/Tools/Iperf/) between your boxes to measure throughput.  There are versions for every platform out there.  We use it back here at Fog Creek, and have discovered some surprising bottlenecks in our topology.  In fact, I wish I had started using it years ago, as I'm sure I would've made better decisions if I had the data.  Well, maybe.\n\nIf you do use this tool, please do both unidirectional  and bidirectional tests.  The bidirectional tests can help uncover interesting gaps that you'll miss when only sending data one way.  In a good environment, the results shouldn't differ much at all from the unidirectional tests.  If they do, then you have found a bottleneck in one of your devices.\n\nAnyway, best of luck!"}, {"author_name": "Jeff Atwood", "gravatar_hash": "51d623f33f8b83095db84ff35e15dbe8", "author_url": "http://www.codinghorror.com/blog/", "date": "Feb 06, 2009", "message": "Guys, just to be clear -- we're talking about a litte over an hour of work to figure this out, from beginning to end.\n\nObviously, I think it is valuable to be able to diagnose and fix problems like this. Even for programmers."}, {"author_name": "Jeff Atwood", "gravatar_hash": "51d623f33f8b83095db84ff35e15dbe8", "author_url": "http://www.codinghorror.com/blog/", "date": "Feb 06, 2009", "message": "> Either way, consider using IPerf (http://www.noc.ucf.edu/Tools/Iperf/) between your boxes to measure throughput\n\nfrom db to web:\n\niperf -c 192.168.0.2\n[ ID] Interval       Transfer     Bandwidth\n[156]  0.0-10.0 sec   485 MBytes   407 Mbits/sec\n\niperf -c 192.168.0.2 -w 2m\n[ ID] Interval       Transfer     Bandwidth\n[156]  0.0-10.0 sec   938 MBytes   785 Mbits/sec\n\nfrom web to db:\n\niperf -c 192.168.0.1\n[ ID] Interval       Transfer     Bandwidth\n[156]  0.0-10.0 sec   343 MBytes   287 Mbits/sec\n\niperf -c 192.168.0.1 -w 2m\n[ ID] Interval       Transfer     Bandwidth\n[156]  0.0-10.0 sec   588 MBytes   491 Mbits/sec"}, {"author_name": "\u00d3lafur Waage", "gravatar_hash": "89b8f4a7429270308ac301bf7605f974", "author_url": "http://cznp.com/", "date": "Feb 07, 2009", "message": "And now you know, and knowing is half the battle...."}, {"author_name": "Jan", "gravatar_hash": "c95d0b560cd92bcfe0a8a5a6d8bcaf51", "author_url": null, "date": "Feb 07, 2009", "message": "I have actually blown my feet more than once by blindly installing the latest drivers of something.  The lesson I learned: google them up first.  Somebody will have already tried them and suffered the pain for you."}, {"author_name": "Murali Suriar", "gravatar_hash": "085bfa9c259fb798a61d72c5e5a9989a", "author_url": null, "date": "Feb 07, 2009", "message": "Very interesting - good catch and excellent fault finding. How on earth, in this day and age, are people designing server hardware without good Windows support out of the box?\n\nOn a professional note: I've not worked with Netgear managed switches before. What kind of instrumentation does it provide? Are you able to get input/output discards, CRC errors, overruns etc? Does it support remote interrogation via SNMP? If so, is it worth you setting up a Nagios instance or something similar to monitor it (and potentially your servers), given that you're managing everything yourself? Good network/server monitoring can often give early warning of impending doom...\n\nAlso, is there any way for you to get interface statistics on Windows? (The equivalent of 'netstat -i' on Linux?)"}, {"author_name": "Jeff Atwood", "gravatar_hash": "51d623f33f8b83095db84ff35e15dbe8", "author_url": "http://www.codinghorror.com/blog/", "date": "Feb 07, 2009", "message": "> How on earth, in this day and age, are people designing server hardware without good Windows support out of the box?\n\nWell, the real question is why the default in-the-box network drivers for the Broadcom hardware can cause such carnage.\n\nNetwork cards are my lowest priority when updating drivers, usually. I don't think I've ever seen problems with default OS network card drivers before."}, {"author_name": "\u00d3lafur Waage", "gravatar_hash": "89b8f4a7429270308ac301bf7605f974", "author_url": "http://cznp.com/", "date": "Feb 08, 2009", "message": "&gt; Network cards are my lowest priority when updating drivers, usually. I don\u2019t think I\u2019ve ever seen problems with default OS network card drivers before.\n\nYou're in luck then, I've had instances of computers crashing out of the blue due to faulty handling of certain packets with vanilla drivers."}, {"author_name": "kibbee", "gravatar_hash": "2b568071163c0d009635cfa63cf6e6ac", "author_url": "http://www.kibbee.ca", "date": "Feb 08, 2009", "message": "I've had problems with network drivers causing corrupted packets. On my old NForce4 motherboard, using the checksum offloading feature caused packets to come in corrupt.  So I had to turn off that feature to be able to download stuff.  To this day, I don't think they ever fixed the problem."}, {"author_name": "Stephen Taylor", "gravatar_hash": "cbc8e2240caacb5300ad2869487be5e0", "author_url": "http://meandmycode.com", "date": "Feb 08, 2009", "message": "Shame that the sites aren't on much ;), just registered up yesterday (finally) and had two 'offline' periods.. \n\nAh I'm just teasing!"}, {"author_name": "PWills", "gravatar_hash": "8d1b72efe7ffa105425d8c7325be747c", "author_url": null, "date": "Feb 08, 2009", "message": "Jeff, sorry if this has already been mentioned and I missed it, but...\n\nDo you have a device/appliance \"in front of\" the web server(s)? If not, you might want to try adding one (email me for low-cost suggestions). If so, you should play with your forward cache or other settings. You might be sitting on ANOTHER 2x in unrealized network perf gains."}, {"author_name": "Daniel", "gravatar_hash": "6d43da5df0e52fc31c55e6a227bb23f4", "author_url": null, "date": "Feb 08, 2009", "message": "If I had to guess, I'd say the checksum offloading wasn't working with the default drivers, or that it was working but causing excessive latency. Ie, it made CPU load lighter, but at the cost of latency on the tcp stack.\n\nI'd look into gamer NICs, as latency is their foremost concern (when it comes to NICs, of course)."}, {"author_name": "Roger Pence", "gravatar_hash": "bb3427b02a0f39597861faf8d9bb7316", "author_url": null, "date": "Feb 11, 2009", "message": "Jeff asks: \"Well, the real question is why the default in-the-box network drivers for the Broadcom hardware can cause such carnage.\"\n\nThe answer is obvious: the authors of the default drivers clearly didn't think that quality really matters in the big scheme of things!"}, {"author_name": "Techboy", "gravatar_hash": "ef52171c0f3d2660411baca982c68561", "author_url": "http://www.techboy.co.uk", "date": "Feb 11, 2009", "message": "Have you looked at using F5 servers (http://www.f5.com/) to optimise network traffic, perform HTML data compression, XML validation, handle 404/500 page errors, load balancing, etc.?\n\nThis would also reduce load on the back-end web server(s)."}, {"author_name": "Matt", "gravatar_hash": "596dac9c9000943b964ac55269e22946", "author_url": null, "date": "Feb 15, 2009", "message": "I came across this post trying to figure out why 'DOMContentLoaded' in FireBug was showing 6+ seconds to load a web page.  After using Fiddler, I finally figured it out.  I had the path to a .JS file set like this:\n\n//JS/SomeFile.js\n\nin the HTML.  This caused the page to load extremely slow.  When I changed it to /JS/SomeFile.js it took 6 seconds less!  Maybe someone else will stumble across this post with the same problem and this will help them..."}, {"author_name": "Mark Sowul", "gravatar_hash": "25a1efa64f21c0b20e6c9026ac31e9f7", "author_url": "http://www.marksowul.com", "date": "Mar 02, 2009", "message": "Ha, I pinged it as being Broadcom the second you said \"network.\"  Almost every network problem I ever encounter ends up being due to their crappy drivers."}, {"author_name": "Steve", "gravatar_hash": "0944aac4b96b12f8154f2139b29c7722", "author_url": null, "date": "Mar 02, 2009", "message": "This is a perfect example of why I rate hardware companies based on my experiences with their drivers.  I used to hang out with a lot of hardware guys and they all considered software to be an afterthought.  Some employee's college-aged kid usually wrote their drivers.  Not because they didn't care about quality, just that they thought the quality of their hardware utterly overwhelmed any deficiencies in the software."}, {"author_name": "Andrew", "gravatar_hash": "6c0ac7b355788bba8c428b0a12e8f567", "author_url": null, "date": "Mar 03, 2009", "message": "This is a bit annoying as for me, I believe in 'if it aint broke, don't fix it'. This is true with graphics drivers especially if you have an old card.\n\nNew graphics drivers support newer features in whatever version of DirectX is out at the time. But if you have an older card which doesn't support those features in hardware, the new drivers force the card (CPU?) to emulate those new features in software, drastically reducing performance."}]}